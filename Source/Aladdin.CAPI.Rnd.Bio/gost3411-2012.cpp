#define _WINDOWS
#include <windows.h>

///////////////////////////////////////////////////////////////////////////////
// Дополнительные определения
///////////////////////////////////////////////////////////////////////////////
#if _MSC_VER < 1600
typedef unsigned char uint8_t; 
#else 
#include <stdint.h>
#endif

///////////////////////////////////////////////////////////////////////////////
// Интерфейс хэширования
///////////////////////////////////////////////////////////////////////////////
#pragma warning(push)
#pragma warning(disable: 4068)
#include "gost3411-2012.h"
#pragma warning(pop)

///////////////////////////////////////////////////////////////////////////////
// Выполнить хэширование данных
///////////////////////////////////////////////////////////////////////////////
void HashData(const void* pvData, SIZE_T cbData, void* pBuffer)
{
	// инициализировать контекст алгоритма хэширования
	gost3411_2012_ctx_s _ctx; gost3411_2012_init(256, &_ctx); 

	// прохэшировать данные
	gost3411_2012_update(&_ctx, (const uint8_t*)pvData, cbData);

	// получить хэш-значение
	gost3411_2012_final(&_ctx, (uint8_t*)pBuffer); 
}
